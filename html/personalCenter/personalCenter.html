<!DOCTYPE html>
<!-- personalCenter -->
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>个人中心</title>
		<script src="../../lib/js/mui.min.js"></script>
		<link href="../../lib/css/mui.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="../home/public.css" />
		<script type="text/javascript" charset="utf-8">
			mui.init();
		</script>
		<style type="text/css">
			.bottom-shadow-f6f6f6 {
				box-shadow: 0 2px 5px #ebebeb;
			}
			#ItreProme {
				border-radius: 6px;
				overflow: hidden;
				height: 260px;
				background: #FFFFFF;
				z-index: 1200;
				width: 70%;
				position: fixed;
				top: 26%;
				margin-left: 15%;
			}

			#abolishTrue .buttonName {
				display: inline-block;
				height: 45px;
				top: 0;
				position: absolute;
				width: 49%;
				line-height: 45px;
				text-align: center;
				color: #4D4D4D;
			}

			#abolishTrue {
				text-align: center;
				position: absolute;
				bottom: 0;
				width: 100%;
				height: 46px;

			}
			#ItrePromeOne {
				height: 265px;
				/* background: red; */
				background-image: url(../../img/shengjigeingxin-3.png);
				background-repeat: no-repeat;
				background-size: 100% 113px;
			}
			#downloadItem {
				color: #4D4D4D !important;
			}
		</style>
	</head>
	<body class="background-F3F3F3">
		<div class="personalCenter-header background-48A9F6to2985E8">
			<i class="mui-action-back mui-icon mui-icon-left-nav color-fff back"></i>
			<div class="personalCenter-datum hidden bottom-shadow-f6f6f6">
				<img class="circular header-pointer float-left" src="../../img/header-pointer.png">
				<span class="line-height1-2 inline-block margin-top-28" style="width: 150px">
					<span class="color-404040 font-size18 margin-left-4" id="userName"></span><br>
					<span class="color-595959 font-size12 margin-left-4" id="userMsa"></span>
				</span>
				<span class="background-48A9F6to2985E8 flag color-fff inline-block float-right bottom-shadow-b7b7b7" id="userKind"></span>
			</div>
		</div>
		<div class="margin-top28 padding10-0">
			<ul class="mui-table-view margin-bottom-10">
				<li class="mui-table-view-cell" onclick="recordTo()">
					<i class="mui-icon width20 float-left">
						<img class="width20" src="../../img/ReleaseRecords.png">
					</i>
					<span class="margin-left-14 line-height1-5">发布记录</span>
					<span class="mui-badge mui-badge-inverted"></span>
				</li>
			</ul>
			<ul class="mui-table-view margin-bottom-10">
				<li class="mui-table-view-cell full">
					<i class="mui-icon width20 float-left">
						<img class="width20" src="../../img/phone_06.png">
					</i>
					<span class="margin-left-14 line-height1-5">手机</span>
					<span class="mui-badge mui-badge-none color-404040 font-size16" id="userPhone"></span>
				</li>
				<li class="mui-table-view-cell" onclick="personalCenter.resetPassword()">
					<a class="mui-navigate-right">
						<i class="mui-icon width20 float-left">
							<img class="width20" src="../../img/password.png">
						</i>
						<span class="margin-left-14 line-height1-5">重置密码</span>
					</a>
				</li>
				<li class="mui-table-view-cell" onclick="personalCenter.checkNew()">

					<a class="mui-navigate-right">
						<i class="mui-icon width20 float-left">
							<img class="width20" src="../../img/checkNew.png">
						</i>
						<span class="margin-left-14 line-height1-5">检查更新</span>
						<span class="mui-badge mui-badge-inverted"></span>
					</a>
				</li>
			</ul>
		</div>
		<button type="button" class="mui-btn mui-btn-block color-f00 border-e6e6e6" onclick="personalCenter.logout()">退出登录</button>

		<!-- 弹框 -->
		<div id="ItreProme" style="display: none;">
			<div id="ItrePromeOne">
				<div style="color:#FFFFFF;padding-top: 50px;padding-left: 24px;height: 80px;"><span id="mustVersion"></span></div>
				<div style="height: 180px;font-size: 12px;padding: 0 10px;padding-top: 40px;">
					【优化】<br />
					1.修复了打印闪退的问题<br />
					2.新增“协同检查人<br />
					<!-- 【新增】<br />
					1.新增查看检查历史和隐患追踪的功能<br />
					2.新增无隐患状况下“水上安全隐患治理建议”打印<br />
					3.检查单发布前新增“备注/安全建议”填写<br /> -->
					</div>
			</div>
			<div id="abolishTrue">
				<div style="height: 1px;background: #CCCCCC;margin: 0;padding: 0;"></div>
				<div>
					<span class="buttonName" style="left: 0;" onclick="trueNameFor()">暂不升级</span>
					<span style="width: 1px;background: #CCCCCC;height: 45px;display: inline-block;"></span>
					<span class="buttonName" style="right: 0;" onclick="trueNameTo()"><a href="" id="downloadItem" download="true">立即升级</a></span>
				</div>
			</div>
		</div>

	</body>
	<script type="text/javascript" src="../password/personalCenter.js"></script>
	<script src="../../lib/js/jquery1.9.1.min.js"></script>
	<script type="text/javascript">
		var downloadUrl
		window.onload = function() {
			mui.ajax(localStorage.getItem("url") + "/checklist/getUserInfo", {
				data: {},
				success: function(res) {
					if (res.code == 200) {
						mui("#userName")[0].textContent = res.data.response.userInfo.name;
						mui("#userMsa")[0].textContent = res.data.response.userInfo.departmentName;
						mui("#userKind")[0].textContent = res.data.response.userInfo.roleName;
						mui("#userPhone")[0].textContent = res.data.response.userInfo.mobile;
					}
				}
			})
		}

		function recordTo() {
			mui.openWindow({
				id: 'recordPage.html',
				url: 'recordPage.html',
			})
		}
		mui.init({
			swipeBack: false,
			gestureConfig: {
				tap: true, //默认为true
				doubletap: true, //默认为false
				longtap: true, //默认为false
				swipe: true, //默认为true
				drag: true, //默认为true
				hold: true, //默认为false，不监听
				release: true //默认为false，不监听
			}
		})
		function trueNameTo() {
			$('#ItreProme').css('display', 'none')
			$('.mui-backdrop').css('display', 'none')
			plus.nativeUI.toast("正在准备环境，请稍后！");
			sleep(1000);
			var path = downloadUrl; //下载apk
			plus.runtime.install(path)
		}
	function sleep(numberMillis) {
			var now = new Date();
			var exitTime = now.getTime() + numberMillis;
			while (true) {
				now = new Date();
				if (now.getTime() > exitTime)
					return;
			}
		}
		function trueNameFor() {
			$('#ItreProme').css('display', 'none')
			$('.mui-backdrop').css('display', 'none')
		}
		$('.buttonName')[0].addEventListener("hold", function() {
			$('.buttonName').eq(0).css('color', '#44A5F4')
		})
		$('.buttonName')[0].addEventListener("release", function() {
			$('.buttonName').eq(0).css('color', '#4D4D4D')
		})
		$('.buttonName')[1].addEventListener("hold", function() {
			$('#downloadItem').css('color', '#44A5F4')
		})
		$('.buttonName')[1].addEventListener("release", function() {
			$('#downloadItem').css('color', '#44A5F4')
		})
	</script>
</html>
